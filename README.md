# _Ursa miner_

_Ursa miner_ is a quick hack to support the use of bootstrap data generated by the [kallisto](http://pachterlab.github.io/kallisto) tool from Lior Pachter's group.

## Requirements

        pip install numpy
        pip install pandas
        pip install h5py

## Usage

`ursa.py {describe | extract} path/to/abundance.h5`

### describe

The `describe` function emits the same data present in kallisto's `run_info.json` file, but sources it from the HDF5 instead. This ensures the HDF5 store is independent / you only need keep up with one file per run.

        $ ursa.py describe abundance.h5
        
        Kallisto version     : 0.42.2.1
        Index version        : 10
        Number of targets    : 121375
        Number of bootstraps : 100
        Kallisto started     : Thu Aug 13 19:22:09 2015
        Command              : kallisto quant -i /home/you/indices/kallisto_index -o OUTDIR --bias -t 32 -b 100 fastqgz/140822_XJB05_V1T_1_GATCAG_L001_R1.fastq.gz fastqgz/140822_XJB05_V1T_1_GATCAG_L001_R2.fastq.gz fastqgz/140903_XJB05_V1T_2_GATCAG_L005_R1.fastq.gz fastqgz/140903_XJB05_V1T_2_GATCAG_L005_R2.fastq.gz

### extract

The `extract` function examines the HDF5 store

        $ ursa.py extract abundance.h5


## FAQ

1. You misspelled _Ursa minor_
Nope. That's also a statement, not a question.

2. Why didn't you use `pandas` build-in HDF5 support?
The HDF5 support in `pandas` is build on pytables; pytables unfortunately does not support the HDF5 format used by kallisto. The excellent `h5py` library, however, does. [h5py](https://github.com/h5py/h5py)

3. How is the TPM calculated?
* For experiments in which no bootstrapping was done, directly from the only available est\_counts (naturally).
* For experiments in which bootstrapping was performed, from the mean of est\_counts across all runs.

3. Why is there not one or more measures of uncertainty for the TPM value?
I need to double check with my statistican, or the Pachter group can chime in, on the correct way to express the confidence bounds surrounding TPM, which is a value derived from the estimated counts that itself has uncertain measures.

